<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Earning Platform</title>
<script src="//libtl.com/sdk.js" data-zone="9789039" data-sdk="show_9789039"></script>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
:root{--bg:#121212;--text:#e0e0e0;--btn:#007bff;--btnText:#fff;--card:#1e1e1e;--border:#333;--success:#28a745;--danger:#dc3545;}
body{font-family:Arial,sans-serif;margin:0;padding:20px 15px 90px 15px;background:var(--bg);color:var(--text);display:flex;flex-direction:column;align-items:center;min-height:100vh;text-align:center;}
.container{width:100%; max-width:500px;}
.view{display:none;width:100%;animation:fadeIn 0.3s ease-in-out;}
#home-view{display:block;}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px);}to{opacity:1;transform:translateY(0);}}
.header{margin-bottom:25px;}
.header h1{font-size:32px;font-weight:700;margin-bottom:5px;color:#fff;}
.header p{color:#8a8a8a;font-size:16px;}
.card{background:var(--card);padding:25px;border-radius:16px;margin-bottom:25px;box-shadow:0 8px 16px rgba(0,0,0,0.2);border:1px solid var(--border);}
.card h2{margin:0 0 12px 0;font-size:16px;color:#8a8a8a;font-weight:500;text-transform:uppercase;letter-spacing:0.5px;}
.balance-amount{font-size:42px;font-weight:700;color:#fff;margin-bottom:10px;}
.ad-info-grid{display:grid;grid-template-columns:1fr 1fr;gap:15px;text-align:center;}
.ad-info-item h3{font-size:20px;font-weight:600;margin:0 0 5px 0;color:#fff;}
.ad-info-item p{font-size:14px;color:#8a8a8a;margin:0;}
.ad-buttons{display:flex;flex-direction:column;gap:15px;margin-bottom:25px;}
.btn{width:100%;padding:16px;font-size:18px;font-weight:600;border:none;border-radius:12px;cursor:pointer;transition: transform 0.2s ease, background-color 0.2s ease, box-shadow 0.2s ease;background:linear-gradient(145deg,var(--btn),#0056b3);color:var(--btnText);box-shadow:0 4px 10px rgba(0,123,255,0.2);}
.btn:hover{transform:translateY(-2px);box-shadow:0 6px 15px rgba(0,123,255,0.3);}
.btn:active{transform:scale(0.98);}
.btn:disabled{background:#555;color:#888;cursor:not-allowed;box-shadow:none;transform:none;}
#mainWithdrawBtn{background:linear-gradient(145deg,var(--success),#1e7e34);box-shadow:0 4px 10px rgba(40,167,69,0.2);}
#mainWithdrawBtn:disabled{background:#555;box-shadow:none;}
.status-message{position:fixed;bottom:80px;left:50%;transform:translateX(-50%);width:90%;max-width:480px;padding:12px 15px;border-radius:10px;font-weight:500;display:none;animation:fadeIn 0.3s;z-index:1000;box-sizing:border-box;}
.success{display:block;background-color:rgba(40,167,69,0.25);border-left:5px solid var(--success);color:var(--success);}
.error{display:block;background-color:rgba(220,53,69,0.25);border-left:5px solid var(--danger);color:var(--danger);}
.info{display:block;background-color:rgba(0,123,255,0.25);border-left:5px solid var(--btn);color:#008cff;}
.footer-nav{position:fixed;bottom:0;left:0;right:0;background-color:var(--card);display:flex;justify-content:space-around;padding:10px 0;box-shadow:0 -4px 12px rgba(0,0,0,0.3);border-top:1px solid var(--border);z-index:999;}
.nav-btn{background:none;border:none;color:#8a8a8a;display:flex;flex-direction:column;align-items:center;font-size:12px;font-weight:500;cursor:pointer;padding:5px 15px;border-radius:12px;transition:color 0.2s, background-color 0.2s;}
.nav-btn.active{color:var(--btn);}
.nav-btn:hover:not(.active){color:#fff;}
.nav-btn .icon{width:28px;height:28px;margin-bottom:4px;}
.payment-icons{display:flex; justify-content:space-around; margin-top:10px;}
.payment-icons img{width:50px;height:50px; cursor:pointer; border-radius:8px; transition: transform 0.2s, box-shadow 0.2s;}
.payment-icons img:hover{transform:scale(1.1);box-shadow:0 4px 12px rgba(0,0,0,0.4);}
.payment-icons img.selected{border:2px solid #007bff;}
</style>
</head>
<body>
<div class="container">

<!-- Home View -->
<div id="home-view" class="view">
  <div class="header"><h1>Earning Platform</h1><p>Watch Ads & Earn USDT</p></div>
  <div class="card">
    <h2>Current Balance</h2>
    <div class="balance-amount" id="balanceDisplay">USDT 0.00</div>
    <div class="ad-info-grid">
      <div class="ad-info-item"><h3 id="adCountDisplay">0</h3><p>Total Ads Watched</p></div>
      <div class="ad-info-item"><h3 id="dailyAdCountDisplay">0 / 20</h3><p>Today's Ads</p></div>
    </div>
  </div>
  <div class="ad-buttons">
    <button class="btn" id="watchNow1">Watch Now 1</button>
    <button class="btn" id="watchNow2" style="display:none;">Watch Now 2</button>
    <button class="btn" id="watchNow3">Fast Earn</button>
  </div>
</div>

<!-- Referral View -->
<div id="referral-view" class="view">
  <h1>Referral</h1>
  <p>Share your referral link and earn rewards!</p>
  <div id="referralLink" style="cursor:pointer; background:#111; padding:10px; border-radius:8px; word-break:break-word;"></div>
</div>

<!-- Withdraw View -->
<div id="withdraw-view" class="view">
  <h1>Withdraw</h1>
  <p>Choose account to withdraw (Min 20 USD):</p>
  <div class="payment-icons">
    <img src="https://upload.wikimedia.org/wikipedia/commons/6/6f/Binance_Logo.png" alt="Binance" id="binanceBtn">
    <img src="https://upload.wikimedia.org/wikipedia/commons/3/36/Bybit_logo.png" alt="Bybit" id="bybitBtn">
    <img src="https://upload.wikimedia.org/wikipedia/commons/b/b5/PayPal.svg" alt="PayPal" id="paypalBtn">
  </div>
  <div class="ad-buttons">
    <button class="btn" id="mainWithdrawBtn" disabled>Withdraw</button>
  </div>
</div>

<div class="status-message" id="statusMessage"></div>

<footer class="footer-nav">
  <button class="nav-btn active" id="navHome"><span class="icon">üè†</span><span>Home</span></button>
  <button class="nav-btn" id="navReferral"><span class="icon">üîó</span><span>Referral</span></button>
  <button class="nav-btn" id="navWithdraw"><span class="icon">üí∞</span><span>Withdraw</span></button>
</footer>

<script>
document.addEventListener('DOMContentLoaded', function(){
const tg = window.Telegram.WebApp;

// Elements
const balanceDisplay=document.getElementById('balanceDisplay');
const adCountDisplay=document.getElementById('adCountDisplay');
const dailyAdCountDisplay=document.getElementById('dailyAdCountDisplay');
const watchNow1=document.getElementById('watchNow1');
const watchNow3=document.getElementById('watchNow3');
const mainWithdrawBtn=document.getElementById('mainWithdrawBtn');
const referralLink=document.getElementById('referralLink');
const statusMessage=document.getElementById('statusMessage');

const WITHDRAW_THRESHOLD=2000; // 20 USD in cents
const AD_REWARD=2; // 0.02 cents
const DAILY_LIMIT=20;

let state={balanceInCents:0,totalAdCount:0,dailyAdCount:0,lastAdDate:null};
let selectedPlatform = null;

// Utilities
function getToday(){return new Date().toISOString().split('T')[0];}
function saveState(){localStorage.setItem('earningState',JSON.stringify(state));}
function loadState(){
  try{let s=JSON.parse(localStorage.getItem('earningState')); if(s) state={...state,...s};}catch{}
  if(state.lastAdDate!==getToday()){state.dailyAdCount=0;state.lastAdDate=getToday();saveState();}
}
function showStatus(msg,type='info',dur=3000){statusMessage.textContent=msg;statusMessage.className=`status-message ${type}`;statusMessage.style.display='block'; setTimeout(()=>{statusMessage.style.display='none';},dur);}
function updateUI(){
  balanceDisplay.textContent=`USDT ${(state.balanceInCents/100).toFixed(2)}`;
  adCountDisplay.textContent=state.totalAdCount;
  dailyAdCountDisplay.textContent=`${state.dailyAdCount} / ${DAILY_LIMIT}`;
  mainWithdrawBtn.disabled = (state.balanceInCents < WITHDRAW_THRESHOLD || !selectedPlatform);
}

// Generate referral
function generateReferral(){
  const user=tg.initDataUnsafe.user;
  if(user && user.id){referralLink.textContent=`https://t.me/Monetag_alamin_bot?start=${user.id}`;}
}

// Watch Ads
function watchAd(type){
  if(state.dailyAdCount>=DAILY_LIMIT){showStatus("Daily ad limit reached","error");return;}
  showStatus("Loading Ad...","info");

  let adPromise;
  if(type===1) adPromise = show_9789039();
  else if(type===3) adPromise = show_9789039({type:'inApp', inAppSettings:{frequency:2,capping:0.1,interval:30,timeout:5,everyPage:false}});
  else if(type===2) adPromise = show_9789039('pop'); // auto-run pop ad

  adPromise.then(()=>{
    state.totalAdCount++;
    state.dailyAdCount++;
    state.balanceInCents += AD_REWARD;
    saveState();
    updateUI();
    showStatus("+0.02 cents added!","success");
  }).catch(()=>{showStatus("Ad failed or skipped","error");});
}

// Watch Now buttons
watchNow1.addEventListener('click',()=>watchAd(1));
watchNow3.addEventListener('click',()=>watchAd(3));

// Auto-run Watch Now 2 ad
watchAd(2);

// Referral copy
referralLink.addEventListener('click',()=>{navigator.clipboard.writeText(referralLink.textContent);showStatus("Referral link copied!","success");});

// Withdraw platform selection
const binanceBtn=document.getElementById('binanceBtn');
const bybitBtn=document.getElementById('bybitBtn');
const paypalBtn=document.getElementById('paypalBtn');
function selectPlatform(platform, btn){
  selectedPlatform=platform;
  [binanceBtn,bybitBtn,paypalBtn].forEach(b=>b.classList.remove('selected'));
  btn.classList.add('selected');
  updateUI();
}
binanceBtn.addEventListener('click',()=>selectPlatform('Binance',binanceBtn));
bybitBtn.addEventListener('click',()=>selectPlatform('Bybit',bybitBtn));
paypalBtn.addEventListener('click',()=>selectPlatform('PayPal',paypalBtn));

// Withdraw button
mainWithdrawBtn.addEventListener('click',()=>{
  if(!selectedPlatform){showStatus("Please select a platform","error"); return;}
  if(state.balanceInCents < WITHDRAW_THRESHOLD){showStatus("Insufficient balance","error"); return;}
  state.balanceInCents = 0;
  saveState();
  updateUI();
  showStatus(`Withdrawal request sent to ${selectedPlatform}!`,"success");
});

// Navigation
document.getElementById('navHome').addEventListener('click',()=>{
  document.getElementById('home-view').style.display='block';
  document.getElementById('referral-view').style.display='none';
  document.getElementById('withdraw-view').style.display='none';
  document.getElementById('navHome').classList.add('active');
  document.getElementById('navReferral').classList.remove('active');
  document.getElementById('navWithdraw').classList.remove('active');
});
document.getElementById('navReferral').addEventListener('click',()=>{
  document.getElementById('home-view').style.display='none';
  document.getElementById('referral-view').style.display='block';
  document.getElementById('withdraw-view').style.display='none';
  document.getElementById('navHome').classList.remove('active');
  document.getElementById('navReferral').classList.add('active');
  document.getElementById('navWithdraw').classList.remove('active');
});
document.getElementById('navWithdraw').addEventListener('click',()=>{
  document.getElementById('home-view').style.display='none';
  document.getElementById('referral-view').style.display='none';
  document.getElementById('withdraw-view').style.display='block';
  document.getElementById('navHome').classList.remove('active');
  document.getElementById('navReferral').classList.remove('active');
  document.getElementById('navWithdraw').classList.add('active');
});

// Initialize
loadState();
generateReferral();
updateUI();
tg.ready();
tg.expand();
});
</script>
</body>
</html>
